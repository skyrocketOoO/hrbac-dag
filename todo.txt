- each function should do atomic operation
